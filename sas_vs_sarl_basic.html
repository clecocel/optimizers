<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gain de r√©mun√©ration en passant d'une SAS √† une SARL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¶</text></svg>">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .container {
            max-width: 800px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-top: 50px;
            margin-bottom: 50px; /* Added margin at the bottom */
        }
        .form-check-input:checked {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }
        #salaryInput {
            text-align: right;
            width: 200px; /* Reduced width of the input box */
        }
        .disclaimer {
            font-style: italic;
            color: #6c757d;
        }
        .coming-soon {
            font-weight: bold;
            color: #0d6efd;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="alert alert-info disclaimer mb-4">
            Les calculs pr√©sent√©s sont √† titre indicatif, les gains peuvent avoir des cons√©quences non mod√©lis√©es comme par exemple des droits (retraite, maladie, etc.) inf√©rieurs.
            <br> Le calcul de l'imposition est r√©alis√© sur une base simplifi√©e d'une personne c√©libataire sans enfant afin de montrer les impacts de l'imposition.
        </div>
        <h1 class="mb-4">Gain de r√©mun√©ration en passant d'une SAS √† une SARL</h1>
        
        <div id="followUpQuestion" class="mt-4">
            <p id="questionText" class="fw-bold">Quel est votre salaire brut annuel actuel en tant que dirigeant de votre SAS ?</p>
            <div class="d-flex align-items-center">
                <input type="text" id="salaryInput" class="form-control me-2" required>
                <button class="btn btn-primary" id="analyzeButton">Analyser</button>
            </div>
        </div>

        <div id="result" class="mt-4" style="display: none;"></div>


    </div>

    <script>
        $(document).ready(function() {
            $('#salaryInput').on('input', function() {
                let value = $(this).val().replace(/[^0-9]/g, '');
                if (value) {
                    value = parseInt(value, 10);
                    $(this).val(value.toLocaleString('fr-FR') + ' ‚Ç¨');
                }
            });

            $('#analyzeButton').on('click', submitSalary);

            // Added event listener for Enter key press
            $('#salaryInput').on('keypress', function(e) {
                if (e.which === 13) { // Enter key code
                    e.preventDefault();
                    submitSalary();
                }
            });
        });

        function submitSalary() {
            const yearlySalary = parseInt($('#salaryInput').val().replace(/[^0-9]/g, ''));
            const apiUrl = 'https://mon-entreprise.urssaf.fr/api/v1/evaluate';
            const monthlySalary = Math.round(yearlySalary / 12);

            // Calculate SAS data
            const sasData = {
                "expressions": [
                    "dirigeant . r√©mun√©ration . totale",
                    "salari√© . r√©mun√©ration . net . √† payer avant imp√¥t",
                    "salari√© . r√©mun√©ration . net . pay√© apr√®s imp√¥t"
                ],
                "situation": {
                    "salari√© . contrat . salaire brut": monthlySalary,
                    "entreprise . cat√©gorie juridique": "'SAS'"
                }
            };

            $.when(
                $.ajax({
                    url: apiUrl,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(sasData)
                })
            ).done(function(sasResponse) {
                const yearlyTotalCost = sasResponse.evaluate[0].nodeValue;
                const formattedYearlyTotalCost = yearlyTotalCost.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });
                const monthlyNetSAS = sasResponse.evaluate[1].nodeValue;
                const yearlyNetSAS = monthlyNetSAS * 12;
                const formattedYearlyNetSAS = yearlyNetSAS.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });
                const monthlyNetAfterTaxSAS = sasResponse.evaluate[2].nodeValue;
                const yearlyNetAfterTaxSAS = monthlyNetAfterTaxSAS * 12;
                const formattedYearlyNetAfterTaxSAS = yearlyNetAfterTaxSAS.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });

                // Calculate SARL/EURL comparison
                const sarlComparisonData = {
                    "expressions": [
                        "dirigeant . r√©mun√©ration . net",
                        "dirigeant . r√©mun√©ration . net . apr√®s imp√¥t"
                    ],
                    "situation": {
                        "entreprise . imposition": "'IS'",
                        "entreprise . associ√©s": "'unique'",
                        "entreprise . cat√©gorie juridique": "'SARL'",
                        "dirigeant . r√©mun√©ration . totale": Math.round(yearlyTotalCost)
                    }
                };

                $.ajax({
                    url: apiUrl,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(sarlComparisonData)
                }).done(function(sarlResponse) {
                    const yearlyNetSarl = sarlResponse.evaluate[0].nodeValue;
                    const formattedYearlyNetSarl = yearlyNetSarl.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });
                    const yearlyNetAfterTaxSarl = sarlResponse.evaluate[1].nodeValue;
                    const formattedYearlyNetAfterTaxSarl = yearlyNetAfterTaxSarl.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });

                    const gainSarl = yearlyNetAfterTaxSarl - yearlyNetAfterTaxSAS;
                    const formattedGainSarl = gainSarl.toLocaleString('fr-FR', { style: 'currency', currency: 'EUR' });

                    $('#result').html(`
                        <table class="table table-striped table-hover">
                            <thead class="table-primary">
                                <tr>
                                    <th>Statut</th>
                                    <th>Co√ªt total employeur annuel</th>
                                    <th>Salaire net annuel</th>
                                    <th>Salaire net apr√®s imp√¥t annuel</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>SAS/SASU</td>
                                    <td>${formattedYearlyTotalCost}</td>
                                    <td>${formattedYearlyNetSAS}</td>
                                    <td>${formattedYearlyNetAfterTaxSAS}</td>
                                </tr>
                                <tr>
                                    <td>SARL/EURL</td>
                                    <td>${formattedYearlyTotalCost}</td>
                                    <td>${formattedYearlyNetSarl}</td>
                                    <td>${formattedYearlyNetAfterTaxSarl}</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="alert alert-success mt-4">
                            Gain potentiel en passant √† une SARL/EURL : <strong>${formattedGainSarl} / an.</strong> apr√®s imp√¥t.
                        </div>
                        <div class="card mt-4 bg-light">
                            <div class="card-body">
                                <h5 class="card-title">D√©couvrez notre Simulateur Premium</h5>
                                <p class="card-text">Pour une analyse plus approfondie et personnalis√©e, notre Simulateur Premium offre des fonctionnalit√©s avanc√©es :</p>
                                <ul>
                                    <li>Comparaison d√©taill√©e des droits √† la retraite selon le statut choisi</li>
                                    <li>Optimisation de la r√©partition entre dividendes et salaire</li>
                                    <li>Simulation multi-ann√©es pour une vision √† long terme</li>
                                </ul>
                                <a href="#" class="btn btn-primary">Acc√©der au Simulateur Premium</a>
                            </div>
                        </div>
                    `).show();

                }).fail(function(xhr, status, error) {
                    console.error('Error in SARL comparison:', error);
                    $('#result').append('<div class="alert alert-danger">Une erreur s\'est produite lors du calcul de la comparaison SARL.</div>');
                });
            }).fail(function(xhr, status, error) {
                console.error('Error:', error);
                $('#result').html('<div class="alert alert-danger">Une erreur s\'est produite lors du calcul des co√ªts.</div>').show();
            });
        }
    </script>
</body>
</html>